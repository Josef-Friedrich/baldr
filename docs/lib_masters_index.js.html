<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: lib/masters/index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: lib/masters/index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file Gather informations about all available master slides
 * @module baldr-masters
 */

const fs = require('fs');
const path = require('path');

/**
 * Load the master slide class
 *
 * @param {string} masterName The name of the master slide
 * @param {object} document The HTML DOM Document Object.
 * @param {object} presentation The presentation object.
 * @param {object} propObj Additonal properties for the slides and master objects
 */
var instantiateMaster = function(masterName, document, presentation, propObj) {
  let masterPath = path.join(__dirname, '..', '..', 'masters', masterName);

  let className = 'Master' +
    masterName.charAt(0).toUpperCase() +
    masterName.slice(1);

  let properties = {
    "masterPath": masterPath,
    "masterName": masterName,
    "document": document,
    "presentation": presentation
  };

  let Master = require('baldr-master-' + masterName)[className];
  return new Master(Object.assign({}, properties, propObj));
};

/**
 * Each master slide class extends this class. It provides basic
 * functionality for the master slide classes. This class is a
 * interface for all child classes
 *
 * @interface
 */
var MasterOfMasters = class {

  /**
   * @param {object} propObj
   * @param {string} propObj.masterName Name of the master slide.
   * @param {string} propObj.masterPath Path of the master slide folder.
   * @param {object} propObj.document Javascript document object (DOM) of the render.html
   * @param {object} propObj.presentation The object representation of the presentation.
   * @param {object} propObj.data The slide data
   */
  constructor(propObj) {

    for (let property in propObj) {
      this[property] = propObj[property];
    }

    /**
     * The HTML-Element for the slide content.
     * @type {object}
     */
    this.elemSlide = this.document.getElementById('slide');

    /**
     * The HTML-Element for the modal content.
     * @type {object}
     */
    this.elemModal = this.document.getElementById('modal-content');

    this.elemButtonUp = this.document.getElementById('nav-step-prev');
    this.elemButtonDown = this.document.getElementById('nav-step-next');

    this.stepCount = 0;
    this.stepNo = 0;
    this.stepData = {};
    this.alreadySet = false;
  }

  /**
   * Check if the CSS style file “styles.css” in the master slide
   * folder exists.
   */
  hasCSS() {
    if (fs.existsSync(path.join(this.masterPath, 'styles.css'))) {
      return true;
    }
    else {
      return false;
    }
  }

  /**
   * Add and remove master slide specific CSS styles
   */
  setCSS() {
    let link = this.document.querySelector('#current-master');
    if (link) {
      link.remove();
    }
    if (this.hasCSS()) {
      let head = this.document.getElementsByTagName('head')[0];
      let link = this.document.createElement('link');
      link.id = 'current-master';
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = path.join(this.masterPath, 'styles.css');
      head.appendChild(link);
    }
  }

  /**
   * @private
   */
  setStepButtonsVisibility_(state) {
    this.elemButtonDown.style.visibility = state;
    this.elemButtonUp.style.visibility = state;
  }

  /**
   * @private
   */
  displayStepButtons_() {
    if (this.stepCount > 1) {
      this.setStepButtonsVisibility_('visible');
    }
    else {
      this.setStepButtonsVisibility_('hidden');
    }
  }

  /**
   *
   */
  set() {
    this.hookPreSet();
    this.setCSS();
    this.elemSlide.innerHTML = this.hookSetHTMLSlide();
    this.elemModal.innerHTML = this.hookSetHTMLModal();
    if (!this.alreadySet) {
      this.hookPostFirstSet();
    }
    this.hookPostSet();
    this.alreadySet = true;
    this.displayStepButtons_();
  }

  /**
   * @private
   */
  afterStepNoChange_() {
    if (this.stepNo === 1) {
      this.hookPreFirstStep();
    }
    if (this.stepNo === this.stepCount) {
      this.hookPreLastStep();
    }
    this.hookSetStep();
  }

  /**
   *
   */
  prevStep() {
    if (this.stepNo === 1) {
      this.stepNo = this.stepCount;
    }
    else {
      this.stepNo--;
    }
    this.afterStepNoChange_();
    this.hookPrevStep();
  }

  /**
   *
   */
  nextStep() {
    if (this.stepNo === this.stepCount) {
      this.stepNo = 1;
    }
    else {
      this.stepNo++;
    }
    this.afterStepNoChange_();
    this.hookNextStep();
  }

  /**
   *
   */
  hookPreSet() {}

  /**
   * @return {string} HTML markup which is shown inside the slide element
   */
  hookSetHTMLSlide() {
    return 'No slide loaded.';
  }

  /**
   *
   */
  hookSetHTMLModal() {
    return '';
  }

  /**
   *
   */
  hookPostFirstSet() {}

  /**
   *
   */
  hookPostSet() {}


  /**
   *
   */
  hookPrevStep() {}

  /**
   *
   */
  hookNextStep() {}

  /**
   *
   */
  hookPreFirstStep() {}

  /**
   *
   */
  hookPreLastStep() {}


  /**
   *
   */
  hookSetStep() {}

};

  /**
   * Gather informations about all available master slides.
   */
class Masters {

  /**
   * @param {object} document The HTML DOM Document Object.
   * @param {object} presentation The presentation object.
   * @constructor
   */
  constructor(document, presentation) {

    /**
     * Parent path of all master slide modules.
     * @type {string}
     */
     this.path = path.join(__dirname, '..', '..', 'masters');

    /**
     * Folder name of master slides
     * @type {array}
     */
    this.all = this.getModules();

    for (let name of this.all) {
      this[name] = instantiateMaster(name, document, presentation);
    }
  }

  /**
   * Get the folder off all master slide modules.
   * @return {array} Folder name of master slides
   */
  getModules() {
    return fs.readdirSync(this.path, 'utf8')
      .filter(
        dir => fs.statSync(
          path.join(this.path, dir)
        ).isDirectory()
      );
  }

}

exports.Masters = Masters;
exports.MasterOfMasters = MasterOfMasters;
exports.instantiateMaster = instantiateMaster;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-baldr.html">baldr</a></li><li><a href="module-baldr-master-audio.html">baldr-master-audio</a></li><li><a href="module-baldr-master-camera.html">baldr-master-camera</a></li><li><a href="module-baldr-master-editor.html">baldr-master-editor</a></li><li><a href="module-baldr-master-markdown.html">baldr-master-markdown</a></li><li><a href="module-baldr-master-person.html">baldr-master-person</a></li><li><a href="module-baldr-master-question.html">baldr-master-question</a></li><li><a href="module-baldr-master-quote.html">baldr-master-quote</a></li><li><a href="module-baldr-master-svg.html">baldr-master-svg</a></li><li><a href="module-baldr-masters.html">baldr-masters</a></li><li><a href="module-baldr-test.html">baldr-test</a></li><li><a href="module-lib_misc.html">lib/misc</a></li><li><a href="module-lib_presentation.html">lib/presentation</a></li><li><a href="module-lib_slides.html">lib/slides</a></li><li><a href="module-masters_camera.html">masters/camera</a></li></ul><h3>Classes</h3><ul><li><a href="module-baldr-master-audio-MasterAudio.html">MasterAudio</a></li><li><a href="module-baldr-master-camera-MasterCamera.html">MasterCamera</a></li><li><a href="module-baldr-master-editor-MasterEditor.html">MasterEditor</a></li><li><a href="module-baldr-master-markdown-MasterMarkdown.html">MasterMarkdown</a></li><li><a href="module-baldr-master-person-MasterPerson.html">MasterPerson</a></li><li><a href="module-baldr-master-question-MasterQuestion.html">MasterQuestion</a></li><li><a href="module-baldr-master-quote-MasterQuote.html">MasterQuote</a></li><li><a href="module-baldr-master-svg-MasterSvg.html">MasterSvg</a></li><li><a href="module-baldr-masters-Masters.html">Masters</a></li><li><a href="module-baldr-test-Spectron.html">Spectron</a></li><li><a href="module-lib_presentation-Presentation.html">Presentation</a></li><li><a href="module-lib_slides-Slides.html">Slides</a></li><li><a href="module-masters_camera-MasterCamera.html">MasterCamera</a></li></ul><h3>Interfaces</h3><ul><li><a href="module-baldr-masters-MasterOfMasters.html">MasterOfMasters</a></li></ul><h3>Global</h3><ul><li><a href="global.html#bindFunction">bindFunction</a></li><li><a href="global.html#bindFunctions">bindFunctions</a></li><li><a href="global.html#firstSlide">firstSlide</a></li><li><a href="global.html#main">main</a></li><li><a href="global.html#nextSlide">nextSlide</a></li><li><a href="global.html#nextStep">nextStep</a></li><li><a href="global.html#previousSlide">previousSlide</a></li><li><a href="global.html#prevStep">prevStep</a></li><li><a href="global.html#setMaster">setMaster</a></li><li><a href="global.html#setMasterCamera">setMasterCamera</a></li><li><a href="global.html#setMasterEditor">setMasterEditor</a></li><li><a href="global.html#toggleModal">toggleModal</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sun Nov 05 2017 16:37:45 GMT+0100 (CET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
