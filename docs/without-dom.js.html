<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: without-dom.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: without-dom.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const fs = require('fs')
const path = require('path')
const os = require('os')

/**
 *
 */
let bootstrapConfig = function () {
  let configFile = path.join(os.homedir(), '.baldr.json')
  let config

  if (fs.existsSync(configFile)) {
    config = require(configFile).songbook
  } else {
    config = {}
  }

  if (process.env.BALDR_SONGBOOK_PATH) {
    config.path = process.env.BALDR_SONGBOOK_PATH
  }
  return config
}

/**
 *
 */
class Library {
  constructor (filePath) {
    this.tree = JSON.parse(fs.readFileSync(filePath))

    /**
     * @return {array} Array of folder paths.
     * &lt;code>&lt;pre>
     * {
     *   "Aint-she-sweet": {
     *     "title": "Ain’t she sweet",
     *     "artist": "Milton Ager (1893 - 1979)",
     *     "lyricist": "Jack Yellen",
     *     "folder": "/home/jf/git-repositories/content/lieder/a/Aint-she-sweet",
     *     "slides": [
     *       "01.svg",
     *       "02.svg"
     *     ]
     *   },
     *   "Altes-Fieber": {
     *     "title": "Altes Fieber",
     *     "artist": "Die Toten Hosen",
     *     "musescore": "https://musescore.com/user/12559861/scores/4801717",
     *     "folder": "/home/jf/git-repositories/content/lieder/a/Altes-Fieber",
     *     "slides": [
     *       "01.svg",
     *       "02.svg",
     *       "03.svg",
     *       "04.svg",
     *       "05.svg",
     *       "06.svg"
     *     ]
     *   },
     *   "Always-look-on-the-bright-side": {
     *     "title": "Always look on the bright side of life",
     *     "source": "http://musescore.com/score/158089",
     *     "folder": "/home/jf/git-repositories/content/lieder/a/Always-look-on-the-bright-side",
     *     "slides": [
     *       "01.svg",
     *       "02.svg",
     *       "03.svg",
     *       "04.svg",
     *       "05.svg",
     *       "06.svg"
     *     ]
     *   },
     * &lt;/pre>&lt;/code>
     */
    this.list = Library.flattenTree_(this.tree)
  }

  /**
   * @return {array} Array of folder paths.
   * &lt;code>&lt;pre>
   * {
   *   "Aint-she-sweet": {
   *     "title": "Ain’t she sweet",
   *     "artist": "Milton Ager (1893 - 1979)",
   *     "lyricist": "Jack Yellen",
   *     "folder": "/home/jf/git-repositories/content/lieder/a/Aint-she-sweet",
   *     "slides": [
   *       "01.svg",
   *       "02.svg"
   *     ]
   *   },
   *   "Altes-Fieber": {
   *     "title": "Altes Fieber",
   *     "artist": "Die Toten Hosen",
   *     "musescore": "https://musescore.com/user/12559861/scores/4801717",
   *     "folder": "/home/jf/git-repositories/content/lieder/a/Altes-Fieber",
   *     "slides": [
   *       "01.svg",
   *       "02.svg",
   *       "03.svg",
   *       "04.svg",
   *       "05.svg",
   *       "06.svg"
   *     ]
   *   },
   *   "Always-look-on-the-bright-side": {
   *     "title": "Always look on the bright side of life",
   *     "source": "http://musescore.com/score/158089",
   *     "folder": "/home/jf/git-repositories/content/lieder/a/Always-look-on-the-bright-side",
   *     "slides": [
   *       "01.svg",
   *       "02.svg",
   *       "03.svg",
   *       "04.svg",
   *       "05.svg",
   *       "06.svg"
   *     ]
   *   },
   * &lt;/pre>&lt;/code>
   */
  static flattenTree_ (tree) {
    let newTree = {}
    Object.keys(tree).forEach((abc, index) => {
      Object.keys(tree[abc]).forEach((folder, index) => {
        newTree[folder] = tree[abc][folder]
      })
    })
    return newTree
  }

  getSongById (songID) {
    return this.list[songID]
  }
}

/**
 * info.yml
 *
 *     ---
 *     title: Lemon tree
 *     subtitle:
 *     alias: I’m sitting here
 *     artist: Fools Garden
 *     lyricist:
 *     composer: Heinz Müller / Manfred Meier
 *     country: Deutschland
 *     musescore: https://musescore.com/user/12559861/scores/4801717
 *     source: http://wikifonia.org/node/9928/revisions/13488/view
 *     year: 1965
 *     genre: Spiritual
 *
 * # Mapping
 *
 * * title: title (year)
 * * subtitle: subtitle - alias - country
 * * composer: composer, artist, genre
 * * lyricist: lyricist
 */
class SongMetaData {
  constructor (info) {
    this.rawInfo = info
  }

  /**
   * Extract values of given properties of an object and collect it in
   * an array.
   */
  static collectProperties_ (properties, object) {
    let parts = []
    for (let property of properties) {
      if (property in object) {
        parts.push(object[property])
      }
    }
    return parts
  }

  /**
   * title (year)
   */
  get title () {
    let out
    if ('title' in this.rawInfo) {
      out = this.rawInfo.title
    } else {
      out = ''
    }

    if ('year' in this.rawInfo) {
      return `${out} (${this.rawInfo.year})`
    } else {
      return out
    }
  }

  /**
   * subtitle - alias - country
   */
  get subtitle () {
    return SongMetaData.collectProperties_(
      ['subtitle', 'alias', 'country'],
      this.rawInfo
    ).join(' - ')
  }

  /**
   * composer, artist, genre
   */
  get composer () {
    return SongMetaData.collectProperties_(
      ['composer', 'artist', 'genre'],
      this.rawInfo
    ).join(', ')
  }

  /**
   * lyricist
   */
  get lyricist () {
    if ('lyricist' in this.rawInfo) {
      return this.rawInfo.lyricist
    } else {
      return ''
    }
  }
}
exports.bootstrapConfig = bootstrapConfig
exports.Library = Library
exports.SongMetaData = SongMetaData
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BaldrSongbookModal.html">BaldrSongbookModal</a></li><li><a href="BaldrSongbookSearch.html">BaldrSongbookSearch</a></li><li><a href="BaldrSongbookToc.html">BaldrSongbookToc</a></li><li><a href="Library.html">Library</a></li><li><a href="Modal.html">Modal</a></li><li><a href="ModalManager.html">ModalManager</a></li><li><a href="Song.html">Song</a></li><li><a href="SongMetaData.html">SongMetaData</a></li></ul><h3>Global</h3><ul><li><a href="global.html#bindButtons">bindButtons</a></li><li><a href="global.html#bindShortcuts">bindShortcuts</a></li><li><a href="global.html#bootstrapConfig">bootstrapConfig</a></li><li><a href="global.html#folder">folder</a></li><li><a href="global.html#library">library</a></li><li><a href="global.html#loadByHash">loadByHash</a></li><li><a href="global.html#nextSlide">nextSlide</a></li><li><a href="global.html#previousSlide">previousSlide</a></li><li><a href="global.html#setCurrent">setCurrent</a></li><li><a href="global.html#setSlide">setSlide</a></li><li><a href="global.html#setSongTitle">setSongTitle</a></li><li><a href="global.html#setUrl">setUrl</a></li><li><a href="global.html#slideNumber">slideNumber</a></li><li><a href="global.html#slideNumberMax">slideNumberMax</a></li><li><a href="global.html#slides">slides</a></li><li><a href="global.html#song">song</a></li><li><a href="global.html#songsPath">songsPath</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc</a>.
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
